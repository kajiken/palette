# ====================
#     .zshrc file
# ====================

if type brew &>/dev/null; then
  HOMEBREW_PREFIX=$(brew --prefix)

  # Configure sheldon to use ~/.sheldon directory
  export SHELDON_CONFIG_DIR="$HOME/.sheldon"
  export SHELDON_DATA_DIR="$HOME/.sheldon"

  # Load all plugins via sheldon (zsh-defer, autosuggestions, completions, syntax-highlighting)
  # Syntax highlighting is automatically deferred via custom template in plugins.toml
  eval "$(sheldon source)"

  export GHQPATH=$HOMEBREW_PREFIX/bin/ghq
fi

export DOTFILES_REPOS='kajiken/palette'
_ghq_root=$($GHQPATH root)
_dotfiles_path=$_ghq_root/$($GHQPATH list $DOTFILES_REPOS)
export ZSH=$_dotfiles_path/zsh
unset _ghq_root _dotfiles_path
export XDG_CONFIG_HOME=$HOME/.config

source $ZSH/aliases.zsh
source $ZSH/keybind.zsh
source $ZSH/options.zsh

# Ensure cache directory exists for compinit
mkdir -p "${XDG_CACHE_HOME:-${HOME}/.cache}/zsh"

# Note: peco.zsh is now loaded via sheldon from zsh/defer/ directory

eval "$(starship init zsh)"
eval "$(mise activate zsh)"
